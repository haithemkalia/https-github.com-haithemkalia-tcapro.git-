(()=>{function t(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,a,o,i,u=[],l=!0,c=!1;try{if(o=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;l=!1}else for(;!(l=(r=o.call(e)).done)&&(u.push(r.value),u.length!==n);l=!0);}catch(t){c=!0,a=t}finally{try{if(!l&&null!=e.return&&(i=e.return(),Object(i)!==i))return}finally{if(c)throw a}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}var e;document.addEventListener("DOMContentLoaded",function(){u()});var r=null,a=null,o=!0;function i(){return!document.hidden}function u(){!function(){if(!document.getElementById("statusChart"))return;c().then(function(n){n&&function(){var n=document.getElementById("statusChart");if(!n)return;r&&(r.destroy(),r=null);var e=document.getElementById("status-data");if(!e)return;var a=JSON.parse(e.textContent||"{}"),o=Object.entries(a).filter(function(n){var e=t(n,2);e[0];return e[1]>0}),i=o.map(function(n){return t(n,1)[0]}),u=o.map(function(n){return t(n,2)[1]});if(0===i.length)return;r=new Chart(n,{type:"doughnut",data:{labels:i,datasets:[{data:u,backgroundColor:["#28a745","#ffc107","#dc3545","#17a2b8","#6f42c1","#fd7e14","#20c997","#e83e8c"].slice(0,i.length),borderWidth:2,borderColor:"#fff"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0,font:{size:12}}},tooltip:{callbacks:{label:function(t){var n=t.label||"",e=t.parsed,r=(e/t.dataset.data.reduce(function(t,n){return t+n},0)*100).toFixed(1);return"".concat(n,": ").concat(e," (").concat(r,"%)")}}}},animation:{animateRotate:!0,duration:800}}})}()})}(),document.querySelectorAll(".progress-bar[data-count]").forEach(function(t){var n=parseInt(t.getAttribute("data-count"))||0,e=parseInt(t.getAttribute("data-total"))||1,r=e>0?n/e*100:0;t.style.width=r+"%"}),l()&&o&&(e=setInterval(s,6e4)),document.addEventListener("visibilitychange",function(){document.hidden?(i=!1,e&&(clearInterval(e),e=null)):(i=!0,o&&!e&&(e=setInterval(s,6e4),s()))}),window.addEventListener("focus",function(){i||(i=!0,o&&!e&&(e=setInterval(s,6e4),s()))}),window.addEventListener("blur",function(){i=!1,e&&(clearInterval(e),e=null)})}function l(){return"/"===window.location.pathname||"/index"===window.location.pathname}function c(){return fetch("/api/chart-data").then(function(t){if(!t.ok)throw new Error("Network response was not ok");return t.json()}).then(function(t){return t}).catch(function(t){return null})}function s(){i&&l()&&(c().then(function(t){t&&a&&(a.data.labels=t.labels,a.data.datasets[0].data=t.values,a.update())}),fetch("/api/stats").then(function(t){return t.json()}).then(function(t){var n=document.querySelector(".stats-card .stats-number");n&&(n.textContent=t.total_clients||0)}).catch(function(t){}))}window.dashboardFunctions={refreshDashboardData:s,initializeDashboard:u,toggleAutoRefresh:function(t){o=t,e&&(clearInterval(e),e=null),t&&l()&&(e=setInterval(s,6e4))},manualRefresh:function(){l()&&s()},isDashboardPage:l}})();
//# sourceMappingURL=dashboard.2e6f3d486f5269e9ca88.js.map